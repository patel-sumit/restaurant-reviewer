var resaturentMaster=function(){prevUniqueId=""};resaturentMaster.prototype.createRestaurent=function(){var e={name:"Latitude - Vivanta By Taj",address:{address:"Vivanta By Taj Blue Diamond, 11, Koregaon Park Road, Koregaon Park",area:"Koregaon Park"},cuisine:"European",operating_hours:"12-22",reviews:[{stars:4,name:"Jennifer Appleseed",date:"2016-04-17",review:"The rolls are awesome. They have a limited menu but unmatched expertise. Spicy as promised. Tried their extra chicken roll with egg roti. Wasool Must try."},{stars:3,name:"John Doe",date:"2016-03-22",review:"This is one of the best places to indulge in a kathi kebab roll in Pune. Tender and juicy pieces of chicken , marinated well in the masala when wrapped in the roti cooked in egg. It shall indeed give you a bite of heaven.Do visit the place . And try something that is a huge contribution to Pune's food culture."},{stars:2,name:"John Appleseed",date:"2016-01-02",review:"Neutra williamsburg keytar franzen skateboard, shoreditch pickled banh mi pabst kale chips you probably haven't heard of them art party beard brooklyn knausgaard. Truffaut VHS retro ugh, cornhole cray pinterest tumblr master cleanse squid actually put a bird on it YOLO four loko ethical. "}]},a=new Firebase("https://rest-reviewer.firebaseIO.com");a.child("restaurants").push(e)},resaturentMaster.prototype.loadRestaurants=function(){firebase.database().ref("/Restaurant").on("value",function(e){var a=$.map(e.val(),function(e,a){return[e]}),r=$("#location")[0],t=$("#cuisine")[0];if("0"!=r.value||"0"!=t.value)var i=$.grep(a,function(e){return"0"!=r.value&&"0"!=t.value?e.address.area.indexOf(r.value)>-1&&e.cuisine.indexOf(t.value)>-1:e.address.area.indexOf(r.value)>-1||e.cuisine.indexOf(t.value)>-1});else i=a;for(var s="",n=0;n<i.length;n++)s+='<div class="col-sm-4" id=\''+i[n].id+"'>",s+='<div class="feature-content">',s+='<a href="../restDetails.html?id='+i[n].id+'" ><img src="img/large/'+i[n].id+".jpg\" alt='"+i[n].name+"'></a>",s+='<h2 class="feature-content-title green-text">'+i[n].name+" </h2>",s+=' <p class="feature-content-description">Morbi sagittis justo a velit placerat ullamcorper quis quis velit. Sed convallis at risus ullamcorper auctor. Praesent quis velit neque. Quisque semper porta nisi vitae suscipit. Duis lectus magna, ornare ac scelerisque.',s+=" </p>",s+='<a href="../restDetails.html?id='+i[n].id+'" class="readMoreText">Read More</a>',s+="</div></div>";""==s&&(s="<h2 style='padding:5px 538px;!important;' class=\"feature-content-title green-text\">No Restaurant found </h2>");var o=$("#lstRestaurants");o.empty(),o.html(s),$("#loader")[0].style.display="none"},function(e){console.log("The read failed: "+e.code)})},resaturentMaster.prototype.loadRestaurantDetails=function(e){var a=this;firebase.database().ref("/Restaurant").on("value",function(r){objRest=r,arr=$.map(r.val(),function(e,a){return[e]});for(var t="",i=0;i<arr.length;i++)if(arr[i].id==e){var s=$("#imgRestDetail")[0];s.src="img/small/"+arr[i].id+".jpg",s.alt=arr[i].name;var n=$("#restName");n.empty(),n.html(arr[i].name),n.alt=arr[i].name;var o=$("#restAddress");o.empty(),o.html("Address : "+arr[i].address.address);var l=$("#restCusine");l.empty(),l.html("Cuisine : "+arr[i].cuisine);var d=$("#restOpenTime");d.empty(),d.html("Open time : "+arr[i].operating_hours);var c=arr[i].reviews,t="";t+="<hr/>";for(var u=0;u<c.length;u++){t+='<div class="row">',t+='<div class="col-sm-3">',t+="<div class=\"review-block-name\"><h5 class='review-name' alt='"+c[u].name+"'>"+c[u].name+"</h5></div>",t+='<div class="review-block-date">'+c[u].date+"</div>",t+="</div>",t+='<div class="col-sm-9">';var v="review-container"+a.getUniqueId();t+='<div class="review-block-rate" id=\''+v+"'>";for(var p=1;p<5;p++)t+=p<=c[u].stars?'<span class="glyphicon .glyphicon-star-empty glyphicon-star starsDisplay" ></span>':'<span class="glyphicon .glyphicon-star-empty glyphicon-star-empty starsDisplay"></span>';t+="</div>",t+='<div class="review-description">'+c[u].review+"</div>",t+="</div>",t+="</div>",t+="<hr/>"}var h=$("#container-review-list");h.empty(),h.html(t),$("#loader")[0].style.display="none"}},function(e){console.log("The read failed: "+e.code)})},resaturentMaster.prototype.addNewReview=function(e){var a=this,r="";r+="<hr/>",r+='<div class="row">',r+='<div class="col-sm-3">',r+="<div class=\"review-block-name\"><h5 class='review-name' alt='"+e.name+"'>"+e.name+"</h5></div>",r+='<div class="review-block-date">'+e.date+"</div>",r+="</div>",r+='<div class="col-sm-9">';var t="review-container"+a.getUniqueId();r+='<div class="review-block-rate" id=\''+t+"'>";for(var i=1;i<5;i++)r+=i<=e.stars?'<span class="glyphicon .glyphicon-star-empty glyphicon-star starsDisplay" ></span>':'<span class="glyphicon .glyphicon-star-empty glyphicon-star-empty starsDisplay"></span>';r+="</div>",r+='<div class="review-description">'+e.review+"</div>",r+="</div>",r+="</div>";var s=$("#container-review-list")[0];s.innerHTML=r+s.innerHTML;var n=getUrlVars("id").split("#")[0];firebase.database().ref("/Restaurant/"+n+"/").once("value").then(function(a){arr=$.map(a.val(),function(e,a){return[e]});var r={};r["/Restaurant/"+n+"/reviews/"+arr[5].length]=e,firebase.database().ref().update(r)})["catch"](function(e){console.error(e)})},resaturentMaster.prototype.showRestDetails=function(e){window.location="restDetails.html?id="+e},resaturentMaster.prototype.getUniqueId=function(){for(var e=this;;){var a=new Date,r=a.getUTCDate()+a.getUTCMonth()+a.getUTCHours()+a.getUTCMinutes()+a.getUTCSeconds()+a.getMilliseconds();if(r!=e.prevUniqueId)return e.prevUniqueId=r,r}},resaturentMaster.prototype.validateReview=function(){$("#post-review-form").bootstrapValidator({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},row:{valid:"field-success",invalid:"field-error"},fields:{raterName:{row:".col-xs-5",validators:{notEmpty:{message:"The User Name is required"}}},comment:{row:".col-xs-5",validators:{notEmpty:{message:"comment is required"}}}}}).on("submit",function(e,a){var r=$(e.target);e.isDefaultPrevented()?r.bootstrapValidator("disableSubmitButtons",!1):e.preventDefault()})};
!function(e){var t,n={className:"autosizejs",append:"",callback:!1,resizeDelay:10},i='<textarea aria-hidden="true" aria-label="Enter your review" tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',r=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],s=e(i).data("autosize",!0)[0];s.style.lineHeight="99px","99px"===e(s).css("lineHeight")&&r.push("lineHeight"),s.style.lineHeight="",e.fn.autosize=function(i){return this.length?(i=e.extend({},n,i||{}),s.parentNode!==document.body&&e(document.body).append(s),this.each(function(){function n(){var t,n;"getComputedStyle"in window?(t=window.getComputedStyle(h,null),n=h.getBoundingClientRect().width,e.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(e,i){n-=parseInt(t[i],10)}),s.style.width=n+"px"):s.style.width=Math.max(p.width(),0)+"px"}function a(){var a={};if(t=h,s.className=i.className,c=parseInt(p.css("maxHeight"),10),e.each(r,function(e,t){a[t]=p.css(t)}),e(s).css(a),n(),window.chrome){var o=h.style.width;h.style.width="0px",h.offsetWidth,h.style.width=o}}function o(){var e,r;t!==h?a():n(),s.value=h.value+i.append,s.style.overflowY=h.style.overflowY,r=parseInt(h.style.height,10),s.scrollTop=0,s.scrollTop=9e4,e=s.scrollTop,c&&e>c?(h.style.overflowY="scroll",e=c):(h.style.overflowY="hidden",u>e&&(e=u)),e+=f,r!==e&&(h.style.height=e+"px",g&&i.callback.call(h,h))}function l(){clearTimeout(d),d=setTimeout(function(){var e=p.width();e!==v&&(v=e,o())},parseInt(i.resizeDelay,10))}var c,u,d,h=this,p=e(h),f=0,g=e.isFunction(i.callback),w={height:h.style.height,overflow:h.style.overflow,overflowY:h.style.overflowY,wordWrap:h.style.wordWrap,resize:h.style.resize},v=p.width();p.data("autosize")||(p.data("autosize",!0),("border-box"===p.css("box-sizing")||"border-box"===p.css("-moz-box-sizing")||"border-box"===p.css("-webkit-box-sizing"))&&(f=p.outerHeight()-p.height()),u=Math.max(parseInt(p.css("minHeight"),10)-f||0,p.height()),p.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word",resize:"none"===p.css("resize")||"vertical"===p.css("resize")?"none":"horizontal"}),"onpropertychange"in h?"oninput"in h?p.on("input.autosize keyup.autosize",o):p.on("propertychange.autosize",function(){"value"===event.propertyName&&o()}):p.on("input.autosize",o),i.resizeDelay!==!1&&e(window).on("resize.autosize",l),p.on("autosize.resize",o),p.on("autosize.resizeIncludeStyle",function(){t=null,o()}),p.on("autosize.destroy",function(){t=null,clearTimeout(d),e(window).off("resize",l),p.off("autosize").off(".autosize").css(w).removeData("autosize")}),o())})):this}}(window.jQuery||window.$);var __slice=[].slice;!function(e,t){var n;return n=function(){function t(t,n){var i,r,s,a=this;this.options=e.extend({},this.defaults,n),this.$el=t,s=this.defaults;for(i in s)r=s[i],null!=this.$el.data(i)&&(this.options[i]=this.$el.data(i));this.createStars(),this.syncRating(),this.$el.on("mouseover.starrr focus.starrr","span",function(e){return a.syncRating(a.$el.find("span").index(e.currentTarget)+1)}),this.$el.on("mouseout.starrr",function(){return a.syncRating()}),this.$el.on("click.starrr","span",function(e){return a.setRating(a.$el.find("span").index(e.currentTarget)+1)}),this.$el.on("starrr:change",this.options.change),this.$el.on("keypress.starrr","span",function(e){if(13==e.which)return $("#save-review-box")[0].focus(),a.setRating(a.$el.find("span").index(e.currentTarget)+1)})}return t.prototype.defaults={rating:void 0,numStars:5,change:function(e,t){}},t.prototype.createStars=function(){var e,t,n;for(n=[],e=1,t=this.options.numStars;1<=t?e<=t:e>=t;1<=t?e++:e--)n.push(this.$el.append("<span class='glyphicon .glyphicon-star-empty' tabindex='0'></span>"));return n},t.prototype.setRating=function(e){return this.options.rating===e&&(e=void 0),this.options.rating=e,this.syncRating(),this.$el.trigger("starrr:change",e)},t.prototype.syncRating=function(e){var t,n,i,r;if(e||(e=this.options.rating),e)for(t=n=0,r=e-1;0<=r?n<=r:n>=r;t=0<=r?++n:--n)this.$el.find("span").eq(t).removeClass("glyphicon-star-empty").addClass("glyphicon-star");if(e&&e<5)for(t=i=e;e<=4?i<=4:i>=4;t=e<=4?++i:--i)this.$el.find("span").eq(t).removeClass("glyphicon-star").addClass("glyphicon-star-empty");if(!e)return this.$el.find("span").removeClass("glyphicon-star").addClass("glyphicon-star-empty")},t}(),e.fn.extend({starrr:function(){var t,i;return i=arguments[0],t=2<=arguments.length?__slice.call(arguments,1):[],this.each(function(){var r;if(r=e(this).data("star-rating"),r||e(this).data("star-rating",r=new n(e(this),i)),"string"==typeof i)return r[i].apply(r,t)})}})}(window.jQuery,window),$(function(){return $(".starrr").starrr()}),$(function(){var e=new resaturentMaster;$("#new-review").autosize({append:"\n"});var t=$("#post-review-box"),n=$("#new-review"),i=$("#open-review-box"),r=$("#close-review-box"),s=$("#save-review-box"),a=$("#ratings-hidden");i.click(function(e){t.slideDown(400,function(){$("#new-review").trigger("autosize.resize"),$("#rater-name")[0].focus()}),i.fadeOut(100),r.show()}),r.click(function(e){e.preventDefault(),t.slideUp(300,function(){n.focus(),n[0].value="",$("#rater-name")[0].value="",i.fadeIn(200)}),r.hide(),$(".starrr span").removeClass("glyphicon-star").addClass("glyphicon-star-empty")}),$(".starrr").on("starrr:change",function(e,t){a.val(t)}),s.click(function(s){s.preventDefault();var o=(document.getElementsByTagName("form")[0],{});o.date=(new Date).toISOString().slice(0,10),o.name=$("#rater-name")[0].value,o.review=$("#new-review")[0].value,o.stars=a[0].value;var l="";return""==o.name?l="Please add your name":""==o.review?l="Please add your review":""==o.stars&&(l="Please give your rating"),""!=l?($("#lblMessage")[0].textContent=l,!1):($("#lblMessage")[0].textContent="",e.addNewReview(o),t.slideUp(300,function(){n.focus(),i.fadeIn(200)}),r.hide(),n[0].value="",$("#rater-name")[0].value="",$(".starrr span").removeClass("glyphicon-star").addClass("glyphicon-star-empty"),void 0)})});